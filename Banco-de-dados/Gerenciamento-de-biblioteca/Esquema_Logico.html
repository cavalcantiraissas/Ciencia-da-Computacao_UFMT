<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Esquema Relacional L√≥gico ‚Äì Biblioteca Digital</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'Segoe UI', Arial, sans-serif; background: #f8fafc; color: #1e293b; padding: 32px; }
  h1 { font-size: 1.6rem; color: #1e3a5f; text-align: center; margin-bottom: 4px; }
  .sub { text-align: center; color: #64748b; font-size: 0.85rem; margin-bottom: 30px; }
  h2 { font-size: 1rem; color: #334155; margin: 28px 0 10px; border-bottom: 2px solid #e2e8f0; padding-bottom: 4px; }
  .schema-block { background: #fff; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.07); margin-bottom: 18px; overflow: hidden; }
  .schema-title {
    display: flex; align-items: center; gap: 8px;
    padding: 9px 16px;
    font-weight: 700; font-size: 0.88rem;
    text-transform: uppercase; letter-spacing: 0.5px;
  }
  table { width: 100%; border-collapse: collapse; font-size: 0.81rem; }
  th { background: #f1f5f9; padding: 6px 12px; text-align: left; color: #475569; font-weight: 600; border-bottom: 1px solid #e2e8f0; }
  td { padding: 5px 12px; border-bottom: 1px solid #f1f5f9; vertical-align: top; }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: #fafafa; }
  .pk  { display:inline-block; background:#fef08a; color:#854d0e; font-size:0.65rem; font-weight:700; padding:1px 5px; border-radius:3px; margin-right:3px; }
  .fk  { display:inline-block; background:#bfdbfe; color:#1e40af; font-size:0.65rem; font-weight:700; padding:1px 5px; border-radius:3px; margin-right:3px; }
  .nn  { display:inline-block; background:#bbf7d0; color:#14532d; font-size:0.65rem; font-weight:700; padding:1px 5px; border-radius:3px; margin-right:3px; }
  .uq  { display:inline-block; background:#e9d5ff; color:#581c87; font-size:0.65rem; font-weight:700; padding:1px 5px; border-radius:3px; margin-right:3px; }
  .chk { display:inline-block; background:#fed7aa; color:#9a3412; font-size:0.65rem; font-weight:700; padding:1px 5px; border-radius:3px; margin-right:3px; }
  .ref { font-size: 0.78rem; color: #2563eb; font-style: italic; }
  .nota { font-size:0.8rem; color:#64748b; background:#f8fafc; padding: 8px 12px; border-left: 3px solid #3b82f6; margin: 10px 0; border-radius:0 6px 6px 0; }
  .card-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 8px; }
  .card { background:#fff; border-radius:8px; padding: 12px 16px; box-shadow: 0 1px 6px rgba(0,0,0,0.07); font-size:0.8rem; }
  .card strong { display:block; margin-bottom:4px; color:#1e40af; font-size:0.82rem; }
  .legend { display:flex; flex-wrap:wrap; gap:10px; margin: 20px 0 10px; justify-content:center; font-size:0.75rem; }
  .leg { display:flex; align-items:center; gap:5px; background:#fff; padding:3px 10px; border-radius:5px; box-shadow:0 1px 4px rgba(0,0,0,0.07); }
  .leg-box { width:13px; height:13px; border-radius:2px; }
  .mono { font-family: 'Courier New', monospace; }
</style>
</head>
<body>

<h1>Esquema Relacional L√≥gico</h1>
<p class="sub">Sistema de Gerenciamento de Biblioteca Digital &nbsp;|&nbsp; 3¬™ Forma Normal (3FN)</p>

<div class="legend">
  <div class="leg"><span class="leg-box" style="background:#fef08a;border:1px solid #ca8a04"></span>PK ‚Äì Chave Prim√°ria</div>
  <div class="leg"><span class="leg-box" style="background:#bfdbfe;border:1px solid #3b82f6"></span>FK ‚Äì Chave Estrangeira</div>
  <div class="leg"><span class="leg-box" style="background:#bbf7d0;border:1px solid #22c55e"></span>NN ‚Äì Not Null</div>
  <div class="leg"><span class="leg-box" style="background:#e9d5ff;border:1px solid #a855f7"></span>UQ ‚Äì Unique</div>
  <div class="leg"><span class="leg-box" style="background:#fed7aa;border:1px solid #f97316"></span>CK ‚Äì Check Constraint</div>
</div>

<!-- EDITORA -->
<div class="schema-block">
  <div class="schema-title" style="background:#dbeafe;color:#1e40af;">üì¶ Editora</div>
  <table>
    <tr><th>Atributo</th><th>Tipo</th><th>Restri√ß√µes</th><th>Descri√ß√£o</th></tr>
    <tr><td><span class="pk">PK</span><b>id_editora</b></td><td class="mono">INT</td><td>AUTO_INCREMENT</td><td>Identificador √∫nico da editora</td></tr>
    <tr><td><span class="nn">NN</span>nome</td><td class="mono">VARCHAR(150)</td><td>NOT NULL</td><td>Nome da editora</td></tr>
    <tr><td>localizacao</td><td class="mono">VARCHAR(200)</td><td>‚Äî</td><td>Cidade/Pa√≠s da editora</td></tr>
  </table>
</div>

<!-- LIVRO -->
<div class="schema-block">
  <div class="schema-title" style="background:#dcfce7;color:#166534;">üìö Livro</div>
  <table>
    <tr><th>Atributo</th><th>Tipo</th><th>Restri√ß√µes</th><th>Descri√ß√£o</th></tr>
    <tr><td><span class="pk">PK</span><b>isbn</b></td><td class="mono">VARCHAR(20)</td><td>NOT NULL</td><td>ISBN √∫nico do t√≠tulo (RN001)</td></tr>
    <tr><td><span class="nn">NN</span>titulo</td><td class="mono">VARCHAR(300)</td><td>NOT NULL</td><td>T√≠tulo do livro (RN003)</td></tr>
    <tr><td>ano_publicacao</td><td class="mono">YEAR</td><td>‚Äî</td><td>Ano de publica√ß√£o</td></tr>
    <tr><td>edicao</td><td class="mono">VARCHAR(20)</td><td>‚Äî</td><td>N√∫mero/descri√ß√£o da edi√ß√£o</td></tr>
    <tr><td><span class="fk">FK</span>id_editora</td><td class="mono">INT</td><td>NOT NULL, FK‚ÜíEditora</td><td>Editora do livro (RN002)</td></tr>
  </table>
</div>

<!-- AUTOR -->
<div class="schema-block">
  <div class="schema-title" style="background:#f3e8ff;color:#6b21a8;">‚úçÔ∏è Autor</div>
  <table>
    <tr><th>Atributo</th><th>Tipo</th><th>Restri√ß√µes</th><th>Descri√ß√£o</th></tr>
    <tr><td><span class="pk">PK</span><b>id_autor</b></td><td class="mono">INT</td><td>AUTO_INCREMENT</td><td>Identificador √∫nico do autor (RN001)</td></tr>
    <tr><td><span class="nn">NN</span>nome</td><td class="mono">VARCHAR(200)</td><td>NOT NULL</td><td>Nome completo do autor (RN003)</td></tr>
  </table>
</div>

<!-- LIVRO_AUTOR -->
<div class="schema-block">
  <div class="schema-title" style="background:#f5f5f4;color:#44403c;">üîó Livro_Autor &nbsp;<small style="font-weight:400;font-size:0.75rem;">(tabela associativa ‚Äì RN004: N:M)</small></div>
  <table>
    <tr><th>Atributo</th><th>Tipo</th><th>Restri√ß√µes</th><th>Descri√ß√£o</th></tr>
    <tr><td><span class="pk">PK</span><span class="fk">FK</span><b>isbn</b></td><td class="mono">VARCHAR(20)</td><td>FK‚ÜíLivro(isbn)</td><td>Refer√™ncia ao livro</td></tr>
    <tr><td><span class="pk">PK</span><span class="fk">FK</span><b>id_autor</b></td><td class="mono">INT</td><td>FK‚ÜíAutor(id_autor)</td><td>Refer√™ncia ao autor</td></tr>
  </table>
  <p class="nota">Chave Prim√°ria composta: (isbn, id_autor). Implementa o relacionamento N:M entre Livro e Autor (RN004).</p>
</div>

<!-- EXEMPLAR -->
<div class="schema-block">
  <div class="schema-title" style="background:#ccfbf1;color:#0f766e;">üè∑Ô∏è Exemplar</div>
  <table>
    <tr><th>Atributo</th><th>Tipo</th><th>Restri√ß√µes</th><th>Descri√ß√£o</th></tr>
    <tr><td><span class="pk">PK</span><b>id_exemplar</b></td><td class="mono">INT</td><td>AUTO_INCREMENT</td><td>Identificador √∫nico do item f√≠sico</td></tr>
    <tr><td><span class="fk">FK</span>isbn</td><td class="mono">VARCHAR(20)</td><td>NOT NULL, FK‚ÜíLivro(isbn)</td><td>T√≠tulo ao qual pertence (RN103)</td></tr>
    <tr><td>numero_tombamento</td><td class="mono">VARCHAR(50)</td><td>‚Äî</td><td>C√≥digo de patrim√¥nio f√≠sico</td></tr>
    <tr><td>status</td><td class="mono">ENUM</td><td>DEFAULT 'Disponivel'</td><td>'Disponivel','Emprestado','Reservado','Extraviado'</td></tr>
  </table>
  <p class="nota">Entidade criada para atender RN103: rastreia cada exemplar f√≠sico de um t√≠tulo. Empr√©stimos e Reservas operam no n√≠vel do Exemplar.</p>
</div>

<!-- USUARIO -->
<div class="schema-block">
  <div class="schema-title" style="background:#fee2e2;color:#991b1b;">üë§ Usuario</div>
  <table>
    <tr><th>Atributo</th><th>Tipo</th><th>Restri√ß√µes</th><th>Descri√ß√£o</th></tr>
    <tr><td><span class="pk">PK</span><b>id_usuario</b></td><td class="mono">INT</td><td>AUTO_INCREMENT</td><td>Identificador √∫nico (RN001)</td></tr>
    <tr><td><span class="nn">NN</span>nome</td><td class="mono">VARCHAR(200)</td><td>NOT NULL</td><td>Nome completo (RN003)</td></tr>
    <tr><td><span class="uq">UQ</span>numero_identificacao</td><td class="mono">VARCHAR(50)</td><td>NOT NULL, UNIQUE</td><td>RA/matr√≠cula/SIAPE √∫nico</td></tr>
    <tr><td>status</td><td class="mono">ENUM</td><td>DEFAULT 'Ativo'</td><td>'Ativo','Inativo' (RF002)</td></tr>
    <tr><td>tipo</td><td class="mono">ENUM</td><td>NOT NULL</td><td>'Aluno','Professor' (RF002)</td></tr>
  </table>
</div>

<!-- EMPRESTIMO -->
<div class="schema-block">
  <div class="schema-title" style="background:#ffedd5;color:#9a3412;">üìã Emprestimo</div>
  <table>
    <tr><th>Atributo</th><th>Tipo</th><th>Restri√ß√µes</th><th>Descri√ß√£o</th></tr>
    <tr><td><span class="pk">PK</span><b>id_emprestimo</b></td><td class="mono">INT</td><td>AUTO_INCREMENT</td><td>Identificador da transa√ß√£o</td></tr>
    <tr><td><span class="fk">FK</span>id_exemplar</td><td class="mono">INT</td><td>NOT NULL, FK‚ÜíExemplar</td><td>Exemplar emprestado (RN002, RN103)</td></tr>
    <tr><td><span class="fk">FK</span>id_usuario</td><td class="mono">INT</td><td>NOT NULL, FK‚ÜíUsuario</td><td>Usu√°rio que retirou (RN002)</td></tr>
    <tr><td><span class="nn">NN</span>data_emprestimo</td><td class="mono">DATE</td><td>NOT NULL</td><td>Data da retirada (RF003)</td></tr>
    <tr><td><span class="nn">NN</span><span class="chk">CK</span>data_prevista_devolucao</td><td class="mono">DATE</td><td>NOT NULL, > data_emprestimo</td><td>Prazo de devolu√ß√£o (RN006)</td></tr>
    <tr><td>data_real_devolucao</td><td class="mono">DATE</td><td>NULL (default)</td><td>NULL = n√£o devolvido. Preenchido na devolu√ß√£o (RF004)</td></tr>
  </table>
  <p class="nota"><span class="chk">CK</span> RN006 ‚Äî CHECK: data_prevista_devolucao &gt; data_emprestimo</p>
</div>

<!-- RESERVA -->
<div class="schema-block">
  <div class="schema-title" style="background:#e2e8f0;color:#334155;">üîñ Reserva</div>
  <table>
    <tr><th>Atributo</th><th>Tipo</th><th>Restri√ß√µes</th><th>Descri√ß√£o</th></tr>
    <tr><td><span class="pk">PK</span><b>id_reserva</b></td><td class="mono">INT</td><td>AUTO_INCREMENT</td><td>Identificador da reserva</td></tr>
    <tr><td><span class="fk">FK</span>id_exemplar</td><td class="mono">INT</td><td>NOT NULL, FK‚ÜíExemplar</td><td>Exemplar reservado (RN103)</td></tr>
    <tr><td><span class="fk">FK</span>id_usuario</td><td class="mono">INT</td><td>NOT NULL, FK‚ÜíUsuario</td><td>Usu√°rio que reservou</td></tr>
    <tr><td><span class="nn">NN</span>data_reserva</td><td class="mono">DATETIME</td><td>NOT NULL, DEFAULT NOW()</td><td>Data/hora da reserva ‚Äì base do FIFO (RN102)</td></tr>
    <tr><td>status</td><td class="mono">ENUM</td><td>DEFAULT 'Ativa'</td><td>'Ativa','Cancelada','Atendida' (RN101)</td></tr>
  </table>
  <p class="nota">Prioridade FIFO implementada via ORDER BY data_reserva ASC nas consultas de fila (RC010).</p>
</div>

<!-- MULTA -->
<div class="schema-block">
  <div class="schema-title" style="background:#fee2e2;color:#991b1b;">üí∞ Multa</div>
  <table>
    <tr><th>Atributo</th><th>Tipo</th><th>Restri√ß√µes</th><th>Descri√ß√£o</th></tr>
    <tr><td><span class="pk">PK</span><b>id_multa</b></td><td class="mono">INT</td><td>AUTO_INCREMENT</td><td>Identificador da multa</td></tr>
    <tr><td><span class="fk">FK</span>id_emprestimo</td><td class="mono">INT</td><td>NOT NULL, FK‚ÜíEmprestimo</td><td>Empr√©stimo gerador da multa</td></tr>
    <tr><td><span class="nn">NN</span><span class="chk">CK</span>valor</td><td class="mono">DECIMAL(10,2)</td><td>NOT NULL, ‚â• 0</td><td>Valor em reais da multa (RC008)</td></tr>
    <tr><td>pago</td><td class="mono">TINYINT(1)</td><td>DEFAULT 0</td><td>0=pendente, 1=pago</td></tr>
    <tr><td>data_geracao</td><td class="mono">DATE</td><td>DEFAULT CURRENT_DATE</td><td>Data de emiss√£o da multa</td></tr>
  </table>
</div>

<h2>Relacionamentos e Cardinalidades</h2>
<div class="card-grid">
  <div class="card"><strong>Editora ‚Üí Livro (1:N)</strong>Uma editora publica muitos livros. Um livro pertence a exatamente uma editora. FK: Livro.id_editora ‚Üí Editora.id_editora</div>
  <div class="card"><strong>Livro ‚Üî Autor (N:M)</strong>Um livro pode ter m√∫ltiplos autores; um autor pode escrever m√∫ltiplos livros (RN004). Implementado via Livro_Autor.</div>
  <div class="card"><strong>Livro ‚Üí Exemplar (1:N)</strong>Um t√≠tulo pode ter v√°rios exemplares f√≠sicos (RN103). FK: Exemplar.isbn ‚Üí Livro.isbn</div>
  <div class="card"><strong>Exemplar ‚Üí Emprestimo (1:N)</strong>Um exemplar pode ter v√°rios empr√©stimos ao longo do tempo. FK: Emprestimo.id_exemplar ‚Üí Exemplar.id_exemplar</div>
  <div class="card"><strong>Usuario ‚Üí Emprestimo (1:N)</strong>Um usu√°rio pode fazer v√°rios empr√©stimos. FK: Emprestimo.id_usuario ‚Üí Usuario.id_usuario</div>
  <div class="card"><strong>Exemplar ‚Üí Reserva (1:N)</strong>Um exemplar pode ter v√°rias reservas (fila). FK: Reserva.id_exemplar ‚Üí Exemplar.id_exemplar</div>
  <div class="card"><strong>Usuario ‚Üí Reserva (1:N)</strong>Um usu√°rio pode reservar v√°rios exemplares. FK: Reserva.id_usuario ‚Üí Usuario.id_usuario</div>
  <div class="card"><strong>Emprestimo ‚Üí Multa (1:N)</strong>Um empr√©stimo pode gerar m√∫ltiplas multas. FK: Multa.id_emprestimo ‚Üí Emprestimo.id_emprestimo</div>
</div>

<h2>Normaliza√ß√£o ‚Äì Justificativa 3FN</h2>
<div class="nota" style="margin-top:8px; font-size:0.82rem; line-height:1.7;">
  <b>1FN</b> ‚Äì Todos os atributos s√£o at√¥micos (sem grupos repetitivos). A rela√ß√£o N:M Livro‚ÜîAutor foi decomposta em Livro_Autor.<br>
  <b>2FN</b> ‚Äì Todos os atributos n√£o-chave dependem funcionalmente da chave prim√°ria inteira. Em Livro_Autor, n√£o h√° atributos n√£o-chave; em Emprestimo, todos dependem de id_emprestimo.<br>
  <b>3FN</b> ‚Äì N√£o existem depend√™ncias funcionais transitivas. Ex.: localiza√ß√£o da editora foi separada para a tabela Editora (n√£o fica em Livro). Status e tipo do usu√°rio dependem apenas de id_usuario.
</div>

</body>
</html>
